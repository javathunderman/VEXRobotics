More code courtesy of Ethan. 
