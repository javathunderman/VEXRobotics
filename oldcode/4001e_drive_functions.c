#pragma config(I2C_Usage, I2C1, i2cSensors)
#pragma config(Sensor, dgtl2,  NoSensor,       sensorDigitalOut)
#pragma config(Sensor, dgtl7,  BackEN,         sensorQuadEncoder)
#pragma config(Sensor, dgtl9,  LeftClaw,       sensorDigitalOut)
#pragma config(Sensor, dgtl10, RightClaw,      sensorDigitalOut)
#pragma config(Sensor, dgtl11, RightEN,        sensorQuadEncoder)
#pragma config(Sensor, I2C_1,  FrontEN,        sensorQuadEncoderOnI2CPort,    , AutoAssign)
#pragma config(Sensor, I2C_2,  RightLiftEN,    sensorQuadEncoderOnI2CPort,    , AutoAssign)
#pragma config(Sensor, I2C_3,  BackEN,         sensorNone)
#pragma config(Motor,  port2,           LeftMotor,     tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port3,           RightMotor,    tmotorVex393_MC29, openLoop, reversed, encoderPort, dgtl11)
#pragma config(Motor,  port4,           BackMotor,     tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port5,           FrontMotor,    tmotorVex393_MC29, openLoop, reversed, encoderPort, I2C_1)
#pragma config(Motor,  port6,           Lift1,         tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port7,           Lift2,         tmotorVex393_MC29, openLoop, reversed, encoderPort, I2C_2)
#pragma config(Motor,  port8,           Lift1b,        tmotorVex393_MC29, openLoop)
#pragma config(Motor,  port9,           Lift2b,        tmotorVex393_MC29, openLoop, reversed)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//
#pragma platform(VEX)

//Competition Control and Duration Settings
#pragma competitionControl(Competition)
#pragma autonomousDuration(20)
#pragma userControlDuration(120)

#include "Vex_Competition_Includes.c"   //Main competition background code...do not modify!


bool LeftPiston = true;
bool RightPiston = true;

///////////////////Methods://////////////////////////////////////////////////////////////////////////////////////////////
void LinearMovement()
{
//Linear movement code : Forward, Left, Right, and Back with left stick
		motor(LeftMotor)=-vexRT[Ch3];
		motor(RightMotor)=-vexRT[Ch3];
		motor(FrontMotor)=vexRT[Ch4];
		motor(BackMotor)=vexRT[Ch4];
}


void Rotation()
{
//Rotation movement code: When 6D is pressed, move right joystick left and right to rotate left and right
	while(vexRT[Btn6D]==1)
	{
		motor(LeftMotor)=-vexRT[Ch1];
		motor(RightMotor)=vexRT[Ch1];
		motor(FrontMotor)=vexRT[Ch1];
		motor(BackMotor)=-vexRT[Ch1];

	}
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void LiftControl()
{

//Lift control: use buttons 5D and 5U to move up and down////Lift max: 8100
	if(vexRT[Btn5U]==1)
	{
		if(SensorValue[FrontEN]<8150 || vexRT[Btn7U]==1)
		{
			motor(Lift1)=127;
			motor(Lift2)=127;
			motor(Lift1b)=127;
			motor(Lift2b)=127;
		}
		else
		{
			motor(Lift1)=0;
			motor(Lift2)=0;
			motor(Lift1b)=0;
			motor(Lift2b)=0;
		}
	}
	else if(vexRT[Btn5D]==1)
	{
		if(SensorValue[FrontEN]>-5 || vexRT[Btn7D]==1)
		{
			motor(Lift1)=-127;
			motor(Lift2)=-127;
			motor(Lift1b)=-127;
			motor(Lift2b)=-127;
		}
		else
		{
			motor(Lift1)=0;
			motor(Lift2)=0;
			motor(Lift1b)=0;
			motor(Lift2b)=0;
		}
	}
	else
	{
		motor(Lift1)=0;
		motor(Lift2)=0;
		motor(Lift1b)=0;
		motor(Lift2b)=0;
	}
}
////////////////////////////////////////////////////////////////////////////////////////////////
void SkyrisePickup()
{
//skyrise pickup height
//Button that lifts to skyrise pickup height,
if(vexRT(Btn6U) == 1)
{
	while(SensorValue(FrontEN) < 1000 && (vexRT(Btn8D) == 0))
	{
		motor(Lift1) = 127;
		motor(Lift2) = 127;
		motor(Lift1b)=127;
		motor(Lift2b)=127;
		LinearMovement();
		Rotation();
	//	PistonClaws();
	}
	while(SensorValue(FrontEN) > 1000 && (vexRT(Btn8D) == 0))
	{
		motor(Lift1) = -127;
		motor(Lift2) = -127;
		motor(Lift1b)=-127;
		motor(Lift2b)=-127;
		LinearMovement();
		Rotation();
//		PistonClaws();
	}
}
}
//////////////////////////////////////////////////////////////////////////////////////////////////
void PistonClaws()
{
	SensorValue[LeftClaw]=1;
	if (vexRT[Btn7R]==1)
	{
	LeftPiston = true;
	}
	if (vexRT[Btn7L]==1)
	{
	LeftPiston = false;
	}
	if (LeftPiston)
	{
	SensorValue[LeftClaw]=1;
	}
	else
	{
	SensorValue[LeftClaw]=0;
	LeftPiston = false;
	}

	SensorValue[RightClaw]=1;
	if (vexRT[Btn8L]==1)
	{
	RightPiston = true;
	}
	if (vexRT[Btn8R]==1)
	{
	RightPiston = false;
	}
	if (RightPiston)
	{
	SensorValue[RightClaw]=1;
	}
	else
	{

	SensorValue[RightClaw]=0;
	RightPiston = false;
	}

}
///////////////////Methods end/////////////////////////////////////////////////////////////////////////////////////////



void pre_auton()
{
	//
}


task autonomous()
{
 //
}


task usercontrol()
{

SensorValue[RightEN]=0;
SensorValue[BackEN]=0;
SensorValue[FrontEN]=0;
SensorValue[RightLiftEN]=0;

while(1==1)
{
		LinearMovement();
		Rotation();
		LiftControl();
		SkyrisePickup();
		PistonClaws();
}
}
